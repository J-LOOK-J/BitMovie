<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.repository.pay.PaymentRepository">
    <insert id="insertPaymentData" parameterType="payment">
        INSERT INTO payment_tb VALUES
            (payment_pk=#{payment_pk},user_pk=#{user_pk},
             pay_type=#{pay_type},pay_price=#{pay_price},
             pay_date=#{pay_date},pay_cncl_date=#{pay_cncl_date},
             mycoupon_pk=#{mycoupon_pk},pay_use_point=#{pay_use_point},
             pay_state=#{pay_state});
    </insert>

    <select id="selectPaymentData" resultType="int" parameterType="payment">
        SELECT * FROM payment_tb WHERE payment_pk=#{payment_pk}
    </select>

    <!--  영화 출력시 필요한 예매울 분모 계산 (날짜기준 총 결제 매수)  -->
    <select id="selectTotalPay" parameterType="Map" resultType="int">
        SELECT sum(s.scr_tot_seat)
        FROM screentime_tb tim, screen_tb s
        WHERE tim.screen_pk = s.screen_pk AND tim.scrt_date > #{begin_date} AND #{now_date} >= tim.scrt_date
    </select>
</mapper>
