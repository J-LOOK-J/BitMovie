<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.repository.pay.BookingRepository">
    <!-- 예매 내역 저장  -->
    <insert id="insertBookingData" parameterType="booking">
        INSERT INTO booking_tb VALUES
            (null,#{payment_pk},#{scrtime_pk},#{book_seat_num}
            ,#{book_the_name},#{book_issu_date},#{book_adult_cnt},#{book_youth_cnt});
    </insert>

    <!-- 상영 및 상영에정 영화 리스트 조회 -->
    <select id="selectScreeningMovieList" resultType="movie">
        SELECT * FROM movie_tb mt WHERE mt.m_sdate &lt;= now() order by m_name desc;
    </select>

    <!-- 현재 예매되어 있는 좌석번호 조회-->
    <select id="selectSeatNumData" resultType="String" parameterType="int">
        SELECT group_concat(book_seat_num)
            AS seat_num
        FROM booking_tb
        WHERE scrtime_pk=#{scrtime_pk}
        GROUP BY scrtime_pk;
    </select>
</mapper>
